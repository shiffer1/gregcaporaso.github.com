<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Lecture 4: From DNA to protein (part1, continued), and python programming &mdash; bioinformatics@nau</title>
    
    <link rel="stylesheet" href="../../../static/haiku.css" type="text/css" />
    <link rel="stylesheet" href="../../../static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../static/jquery.js"></script>
    <script type="text/javascript" src="../../../static/underscore.js"></script>
    <script type="text/javascript" src="../../../static/doctools.js"></script>
    <link rel="top" title="bioinformatics@nau" href="../../../index.html" />
    <link rel="up" title="Lecture outlines" href="index.html" />
    <link rel="next" title="Lecture 5: DNA to Protein; part 2: mRNA to Protein" href="lecture5.html" />
    <link rel="prev" title="Lecture 3: From DNA to protein (part 1): DNA to mRNA" href="lecture3.html" /> 
  </head>
  <body>
      <div class="header"><h1 class="heading"><a href="../../../index.html">
          <span>bioinformatics@nau</span></a></h1>
        <h2 class="heading"><span>Lecture 4: From DNA to protein (part1, continued), and python programming</span></h2>
      </div>
      <div class="topnav">
      
        <p>
        «&#160;&#160;<a href="lecture3.html">Lecture 3: From DNA to protein (part 1): DNA to mRNA</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="../../../index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="lecture5.html">Lecture 5: DNA to Protein; part 2: mRNA to Protein</a>&#160;&#160;»
        </p>

      </div>
      <div class="content">
        
        
  <div class="section" id="lecture-4-from-dna-to-protein-part1-continued-and-python-programming">
<h1>Lecture 4: From DNA to protein (part1, continued), and python programming<a class="headerlink" href="#lecture-4-from-dna-to-protein-part1-continued-and-python-programming" title="Permalink to this headline">¶</a></h1>
<div class="section" id="chromosome-structure">
<h2>Chromosome structure<a class="headerlink" href="#chromosome-structure" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>DNA is highly compressed (particularly in eukaryotes, but see <a class="reference external" href="http://www.nature.com/scitable/topicpage/genome-packaging-in-prokaryotes-the-circular-chromosome-9113">here</a> for a discussion of DNA supercoiling in bacteria)</li>
<li><a class="reference external" href="http://www.nature.com/scitable/topicpage/chromosomes-14121320">Compression of eukaryotic DNA into chromosomes</a> affects access of RNA polymerase to sequences to be transcribed (heterochromatin versus euchromatin).</li>
</ul>
</div>
<div class="section" id="review-of-the-lpthw-exercises-so-far">
<h2>Review of the LPTHW exercises, so far<a class="headerlink" href="#review-of-the-lpthw-exercises-so-far" title="Permalink to this headline">¶</a></h2>
<div class="section" id="printing-key-concepts">
<h3>Printing: key concepts<a class="headerlink" href="#printing-key-concepts" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p class="first">Several types of quotes can be used: <tt class="docutils literal"><span class="pre">&quot;</span></tt>, <tt class="docutils literal"><span class="pre">'</span></tt>, <tt class="docutils literal"><span class="pre">'''</span></tt>, and <tt class="docutils literal"><span class="pre">&quot;&quot;&quot;</span></tt></p>
</li>
<li><p class="first">Strings can be join with <tt class="docutils literal"><span class="pre">+</span></tt> or continued across lines by ending a line with a <tt class="docutils literal"><span class="pre">,</span></tt></p>
</li>
<li><p class="first">Several special characters in strings: tab (<tt class="docutils literal"><span class="pre">\t</span></tt>) and new line (<tt class="docutils literal"><span class="pre">\n</span></tt>)</p>
</li>
<li><p class="first">To print a <cite>literal character</cite> you <cite>escape</cite> it with a <cite>\</cite></p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">%s</span></tt> versus <tt class="docutils literal"><span class="pre">%r</span></tt>: the former prints a string while the latter prints python&#8217;s internal representation of a string (hence the surrounding singe quotes). Try this:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">print</span> <span class="s">&quot;this is a test comparing </span><span class="si">%s</span><span class="s"> to </span><span class="si">%r</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="s">&quot;hello&quot;</span><span class="p">,</span><span class="s">&quot;hello&quot;</span><span class="p">)</span>
</pre></div>
</div>
</li>
</ul>
</div>
<div class="section" id="variables">
<h3>Variables<a class="headerlink" href="#variables" title="Permalink to this headline">¶</a></h3>
<p>Variables: a name associated with some value (a number, a string, a list...) for the purposes of storage and reference. These can generally be changed as follows:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">a</span> <span class="o">=</span> <span class="mi">42</span>
<span class="k">print</span> <span class="n">a</span>
<span class="n">a</span> <span class="o">=</span> <span class="mi">43</span>
<span class="k">print</span> <span class="n">a</span>
</pre></div>
</div>
</div>
<div class="section" id="exercise-13-the-sys-module-and-argv">
<h3>Exercise 13: the <tt class="docutils literal"><span class="pre">sys</span></tt> module and <tt class="docutils literal"><span class="pre">argv</span></tt><a class="headerlink" href="#exercise-13-the-sys-module-and-argv" title="Permalink to this headline">¶</a></h3>
<p><tt class="docutils literal"><span class="pre">argv</span></tt> allows you to take parameters from the command line. This is useful for allowing your python scripts (ie., your python <tt class="docutils literal"><span class="pre">.py</span></tt> files) to do different things with different inputs. Here&#8217;s a script that makes use of <tt class="docutils literal"><span class="pre">argv</span></tt> to reverse complement a sequence provided on the command line:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">sys</span> <span class="kn">import</span> <span class="n">argv</span>
<span class="n">script_name</span><span class="p">,</span> <span class="n">sequence</span> <span class="o">=</span> <span class="n">argv</span>
<span class="k">print</span> <span class="n">sequence</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&#39;A&#39;</span><span class="p">,</span><span class="s">&#39;t&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&#39;T&#39;</span><span class="p">,</span><span class="s">&#39;a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&#39;G&#39;</span><span class="p">,</span><span class="s">&#39;c&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&#39;C&#39;</span><span class="p">,</span><span class="s">&#39;g&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">upper</span><span class="p">()[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
<p>For some help with the third line of that script refer back to the <a class="reference external" href="./lecture2.html">Lecture 2 outline</a>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Advanced users should check out the <tt class="docutils literal"><span class="pre">optparse</span></tt> module for interacting with command line arguments. This is what&#8217;s used in PyCogent and QIIME to create very complex command line interfaces which include things like optional and required arguments and help text for scripts.</p>
</div>
</div>
<div class="section" id="exercise-13-packing-and-unpacking-variables">
<h3>Exercise 13: Packing and unpacking variables<a class="headerlink" href="#exercise-13-packing-and-unpacking-variables" title="Permalink to this headline">¶</a></h3>
<p>Exercise 13 also shows how to set multiple variables in one step. This is purely used for convenience and clarity of code. The following code block do the exact same thing:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">44</span><span class="p">,</span> <span class="mi">46</span>
<span class="k">print</span> <span class="n">a</span>
<span class="k">print</span> <span class="n">b</span>
<span class="k">print</span> <span class="n">c</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">a</span> <span class="o">=</span> <span class="mi">42</span>
<span class="n">b</span> <span class="o">=</span> <span class="mi">44</span>
<span class="n">c</span> <span class="o">=</span> <span class="mi">46</span>
<span class="k">print</span> <span class="n">a</span>
<span class="k">print</span> <span class="n">b</span>
<span class="k">print</span> <span class="n">c</span>
</pre></div>
</div>
</div>
<div class="section" id="exercise-15-files">
<h3>Exercise 15: files<a class="headerlink" href="#exercise-15-files" title="Permalink to this headline">¶</a></h3>
<p>On the subject of opening files, let&#8217;s look at a standard bioinformatics file type: the <tt class="docutils literal"><span class="pre">fasta</span></tt> file. You&#8217;ll run into these a lot so it&#8217;s important to understand what they look like. Here&#8217;s an example of a valid fasta file:</p>
<div class="highlight-python"><div class="highlight"><pre>&gt;sequence1 Homo sapiens
ACCGGAGGACCGTACGACTAGCATCACGACTACGACTACAGCATCACGACTACGACTACGACG
ACTACGCACTACTTTTGACACTACGACACACCTAGCTCCGACTACGACGACTGACCGCGATCA
GCAGCATCAGCACGATCAGCACG
&gt;sequence2 Pan troglodytes
ACCGGAGGACCGTACGACTAGCATCACGACTACGACTACAGCATCACGACTACGACTACGACG
ACTACGCACTACTTTAGACACTACGCACCTAGCTCCGACTACGACGACTGACCGCGATCAGCT
GCATCAGCACGAACAGCACC
</pre></div>
</div>
<p>Here&#8217;s a breakdown of what the fields represent:</p>
<div class="highlight-python"><div class="highlight"><pre>&gt;sequence_identifier comment or description
sequence
</pre></div>
</div>
<p><tt class="docutils literal"><span class="pre">&gt;</span></tt>: indicates the beginning of a new sequence record [REQUIRED]</p>
<p><tt class="docutils literal"><span class="pre">sequence_identifier</span></tt>: this is an identifier that is unique within this file and contains no spaces [REQUIRED]</p>
<p><tt class="docutils literal"><span class="pre">comment</span> <span class="pre">or</span> <span class="pre">description</span></tt>: everything after the first space is considered a comment or description &#8211; this is arbitrary and optional text [OPTIONAL]</p>
<p><tt class="docutils literal"><span class="pre">sequence</span></tt>: this is the nucleic acid or protein sequence [REQUIRED]</p>
<p>Let&#8217;s integrate file writing with our reverse complement script. We&#8217;ll take a sequence, a sequence name, and an output file name as input and write the reverse complement of the sequence to file:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">sys</span> <span class="kn">import</span> <span class="n">argv</span>
<span class="n">script_name</span><span class="p">,</span> <span class="n">sequence</span><span class="p">,</span> <span class="n">sequence_name</span><span class="p">,</span> <span class="n">output_fasta_fp</span> <span class="o">=</span> <span class="n">argv</span>

<span class="n">output_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">output_fasta_fp</span><span class="p">,</span><span class="s">&#39;w&#39;</span><span class="p">)</span>
<span class="n">output_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;&gt;</span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">sequence_name</span><span class="p">)</span>
<span class="n">output_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
<span class="n">output_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">sequence</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&#39;A&#39;</span><span class="p">,</span><span class="s">&#39;t&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&#39;T&#39;</span><span class="p">,</span><span class="s">&#39;a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&#39;G&#39;</span><span class="p">,</span><span class="s">&#39;c&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&#39;C&#39;</span><span class="p">,</span><span class="s">&#39;g&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">upper</span><span class="p">()[::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="n">output_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
<span class="n">output_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">I&#8217;m calling my output file name <tt class="docutils literal"><span class="pre">output_fasta_fp</span></tt> here. The <tt class="docutils literal"><span class="pre">fp</span></tt> is shorthand for <cite>filepath</cite>, or the location of the file on the system. By default the file gets written to the <cite>current working directory</cite> (look this term up if it&#8217;s unfamiliar) but you can also specify other places to write the file. For example, on my Apple laptop I could specify <tt class="docutils literal"><span class="pre">/Users/caporaso/Desktop/my.fasta</span></tt> to write the file to my desktop.</p>
</div>
</div>
<div class="section" id="exercises-18-to-21-functions">
<h3>Exercises 18 to 21: Functions<a class="headerlink" href="#exercises-18-to-21-functions" title="Permalink to this headline">¶</a></h3>
<p>Now let&#8217;s spend a little time on functions. Functions are self-contained pieces of code that (usually) take something as input and (usually) return something as output. Let&#8217;s define a <tt class="docutils literal"><span class="pre">reverse_complement</span></tt> function:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">reverse_complement</span><span class="p">(</span><span class="n">sequence</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">sequence</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&#39;A&#39;</span><span class="p">,</span><span class="s">&#39;t&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&#39;T&#39;</span><span class="p">,</span><span class="s">&#39;a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&#39;G&#39;</span><span class="p">,</span><span class="s">&#39;c&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&#39;C&#39;</span><span class="p">,</span><span class="s">&#39;g&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">upper</span><span class="p">()[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
<p>Now try calling this function:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">sequence</span> <span class="o">=</span> <span class="s">&quot;GTTTATCCATCGTGCGTC&quot;</span>
<span class="n">rc_sequence</span> <span class="o">=</span> <span class="n">reverse_complement</span><span class="p">(</span><span class="n">sequence</span><span class="p">)</span>
</pre></div>
</div>
<p>Notice that we didn&#8217;t get any information printed to the screen here. We were previously calling print on the resulting sequence, but here we&#8217;re setting a new variable with that sequence. To see the result you can do the following:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">print</span> <span class="n">rc_sequence</span>
</pre></div>
</div>
<p>Note that you can also call print directly on the return value of the function:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">print</span> <span class="n">reverse_complement</span><span class="p">(</span><span class="n">sequence</span><span class="p">)</span>
</pre></div>
</div>
<p>This is because <tt class="docutils literal"><span class="pre">reverse_complement</span></tt> returns a string, and <tt class="docutils literal"><span class="pre">print</span></tt> takes a string as an argument.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last"><strong>The reverse complement function that we implemented here is incomplete and dangerous.</strong> The reason for this is that it doesn&#8217;t do anything with characters other than <tt class="docutils literal"><span class="pre">A</span></tt>, <tt class="docutils literal"><span class="pre">C</span></tt>, <tt class="docutils literal"><span class="pre">G</span></tt>, and <tt class="docutils literal"><span class="pre">T</span></tt>. Try passing a <tt class="docutils literal"><span class="pre">M</span></tt> somewhere in your sequence. What happens? The reason why this is dangerous is because <tt class="docutils literal"><span class="pre">M</span></tt> (and several other characters) are often used in nucleic acid sequences, despite not being one of the four DNA bases. These other characters are known as <cite>degenerate bases</cite>, and represent more than one possible choice of a base. For example, you may see a sequence that looks like <tt class="docutils literal"><span class="pre">GTTMATCCATCGTGCGTC</span></tt>. This means that the fourth base can either be an <tt class="docutils literal"><span class="pre">A</span></tt> or a <tt class="docutils literal"><span class="pre">C</span></tt>, so the correct reverse complement of <tt class="docutils literal"><span class="pre">M</span></tt> is actually <tt class="docutils literal"><span class="pre">K</span></tt> (the degenerate base representing <tt class="docutils literal"><span class="pre">T</span></tt> or <tt class="docutils literal"><span class="pre">G</span></tt>). Review this list of the <a class="reference external" href="http://www.bioinformatics.org/sms/iupac.html">IUPAC nucleotide bases</a>. What&#8217;s the reverse complement of <tt class="docutils literal"><span class="pre">H</span></tt>? How about <tt class="docutils literal"><span class="pre">W</span></tt>? <strong>We&#8217;ll soon implement a safer version of reverse complement.</strong></p>
</div>
<p>We can also define a <tt class="docutils literal"><span class="pre">transcribe</span></tt> function to simulate the process of transcription. That one is pretty simple - it looks like this:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">transcribe</span><span class="p">(</span><span class="n">sequence</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">sequence</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&#39;T&#39;</span><span class="p">,</span><span class="s">&#39;U&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>You can now transcribe sequences as follows:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">transcribe</span><span class="p">(</span><span class="n">sequence</span><span class="p">)</span>
</pre></div>
</div>
<p>Soon we&#8217;ll build a script that can apply any of these functions to one or more input sequences in a fasta file and write the results to a new fasta file. There&#8217;s a bit more learning to do before we get there.</p>
</div>
</div>
</div>


      </div>
      <div class="bottomnav">
      
        <p>
        «&#160;&#160;<a href="lecture3.html">Lecture 3: From DNA to protein (part 1): DNA to mRNA</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="../../../index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="lecture5.html">Lecture 5: DNA to Protein; part 2: mRNA to Protein</a>&#160;&#160;»
        </p>

      </div>

    <div class="footer">
        &copy; Copyright 2012, J Gregory Caporaso.
      Last updated on Apr 09, 2015.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.3.
    </div>
  </body>
</html>
